<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Pyrogenesis: /home/sathyam/0ad.svn/source/lib/module_init.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Pyrogenesis
   &#160;<span id="projectnumber">13997</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="dir_e9f938b6a0a3145773b24039556c08b4.html">lib</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">module_init.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="lib_2precompiled_8h_source.html">precompiled.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="module__init_8h_source.html">lib/module_init.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="cpu_8h_source.html">lib/sysdep/cpu.h</a>&quot;</code><br/>
</div>
<p><a href="module__init_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae682d0c308c233bfc98bac095d96fd3c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="status_8h.html#af86dce5ae46a850945a95cfbdcaacd9c">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="module__init_8cpp.html#ae682d0c308c233bfc98bac095d96fd3c">ModuleInit</a> (volatile <a class="el" href="module__init_8h.html#a0622302b481431be62f9460f2cf5260e">ModuleInitState</a> *<a class="el" href="wsdl_8cpp.html#a4688f25e9a88b40c4f52c69323d68c0f">initState</a>, <a class="el" href="status_8h.html#af86dce5ae46a850945a95cfbdcaacd9c">Status</a>(*init)())</td></tr>
<tr class="memdesc:ae682d0c308c233bfc98bac095d96fd3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">calls a user-defined init function if initState is zero.  <a href="#ae682d0c308c233bfc98bac095d96fd3c">More...</a><br/></td></tr>
<tr class="separator:ae682d0c308c233bfc98bac095d96fd3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58e47d81207bc13b3a9063e6db202ccf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="status_8h.html#af86dce5ae46a850945a95cfbdcaacd9c">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="module__init_8cpp.html#a58e47d81207bc13b3a9063e6db202ccf">ModuleShutdown</a> (volatile <a class="el" href="module__init_8h.html#a0622302b481431be62f9460f2cf5260e">ModuleInitState</a> *<a class="el" href="wsdl_8cpp.html#a4688f25e9a88b40c4f52c69323d68c0f">initState</a>, void(*shutdown)())</td></tr>
<tr class="memdesc:a58e47d81207bc13b3a9063e6db202ccf"><td class="mdescLeft">&#160;</td><td class="mdescRight">calls a user-defined shutdown function if initState is "initialized".  <a href="#a58e47d81207bc13b3a9063e6db202ccf">More...</a><br/></td></tr>
<tr class="separator:a58e47d81207bc13b3a9063e6db202ccf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a92564542e0978bc542402277bd0b3a23"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="module__init_8h.html#a0622302b481431be62f9460f2cf5260e">ModuleInitState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="module__init_8cpp.html#a92564542e0978bc542402277bd0b3a23">UNINITIALIZED</a> = 0</td></tr>
<tr class="separator:a92564542e0978bc542402277bd0b3a23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38469fd4e79fdd395f170b3dab46da51"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="module__init_8h.html#a0622302b481431be62f9460f2cf5260e">ModuleInitState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="module__init_8cpp.html#a38469fd4e79fdd395f170b3dab46da51">BUSY</a> = <a class="el" href="namespaceERR.html#af25d90db828542918c9d2a9f2fb0f8ef">ERR::AGAIN</a></td></tr>
<tr class="separator:a38469fd4e79fdd395f170b3dab46da51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10e8f7847f0d3f887269361b40c3cdc1"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="module__init_8h.html#a0622302b481431be62f9460f2cf5260e">ModuleInitState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="module__init_8cpp.html#a10e8f7847f0d3f887269361b40c3cdc1">INITIALIZED</a> = <a class="el" href="namespaceINFO.html#a24f9efb658615bcc13e076c5518f3c4c">INFO::SKIPPED</a></td></tr>
<tr class="separator:a10e8f7847f0d3f887269361b40c3cdc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ae682d0c308c233bfc98bac095d96fd3c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="status_8h.html#af86dce5ae46a850945a95cfbdcaacd9c">Status</a> ModuleInit </td>
          <td>(</td>
          <td class="paramtype">volatile <a class="el" href="module__init_8h.html#a0622302b481431be62f9460f2cf5260e">ModuleInitState</a> *&#160;</td>
          <td class="paramname"><em>initState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="status_8h.html#af86dce5ae46a850945a95cfbdcaacd9c">Status</a>(*)()&#160;</td>
          <td class="paramname"><em>init</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calls a user-defined init function if initState is zero. </p>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="namespaceINFO.html#a24f9efb658615bcc13e076c5518f3c4c">INFO::SKIPPED</a> if already initialized, a Status if the previous invocation failed, or the value returned by the callback.</dd></dl>
<p>postcondition: initState is "initialized" if the callback returned <a class="el" href="namespaceINFO.html#a4e7f848c5a73a2d9d2ca2edb0827d238">INFO::OK</a>, otherwise its Status return value (which prevents shutdown from being called).</p>
<p>thread-safe: subsequent callers spin until the callback returns (this prevents using partially-initialized modules)</p>
<p>note that callbacks typically reference static data and thus do not require a function argument, but that can later be added if necessary. </p>

<p>Definition at line <a class="el" href="module__init_8cpp_source.html#l00040">40</a> of file <a class="el" href="module__init_8cpp_source.html">module_init.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a58e47d81207bc13b3a9063e6db202ccf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="status_8h.html#af86dce5ae46a850945a95cfbdcaacd9c">Status</a> ModuleShutdown </td>
          <td>(</td>
          <td class="paramtype">volatile <a class="el" href="module__init_8h.html#a0622302b481431be62f9460f2cf5260e">ModuleInitState</a> *&#160;</td>
          <td class="paramname"><em>initState</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)()&#160;</td>
          <td class="paramname"><em>shutdown</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calls a user-defined shutdown function if initState is "initialized". </p>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="namespaceINFO.html#a4e7f848c5a73a2d9d2ca2edb0827d238">INFO::OK</a> if shutdown occurred, <a class="el" href="namespaceINFO.html#a24f9efb658615bcc13e076c5518f3c4c">INFO::SKIPPED</a> if initState was zero (uninitialized), otherwise the Status returned by ModuleInit.</dd></dl>
<p>postcondition: initState remains set to the Status, or has been reset to zero to allow multiple init/shutdown pairs, e.g. in self-tests.</p>
<p>note: there is no provision for reference-counting because that turns out to be problematic (a user might call shutdown immediately after init; if this is the first use of the module, it will be shutdown prematurely, which is at least inefficient and possibly dangerous). instead, shutdown should only be called when cleanup is necessary (e.g. at exit before leak reporting) and it is certain that the module is no longer in use. </p>

<p>Definition at line <a class="el" href="module__init_8cpp_source.html#l00065">65</a> of file <a class="el" href="module__init_8cpp_source.html">module_init.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a38469fd4e79fdd395f170b3dab46da51"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="module__init_8h.html#a0622302b481431be62f9460f2cf5260e">ModuleInitState</a> BUSY = <a class="el" href="namespaceERR.html#af25d90db828542918c9d2a9f2fb0f8ef">ERR::AGAIN</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="module__init_8cpp_source.html#l00035">35</a> of file <a class="el" href="module__init_8cpp_source.html">module_init.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a10e8f7847f0d3f887269361b40c3cdc1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="module__init_8h.html#a0622302b481431be62f9460f2cf5260e">ModuleInitState</a> INITIALIZED = <a class="el" href="namespaceINFO.html#a24f9efb658615bcc13e076c5518f3c4c">INFO::SKIPPED</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="module__init_8cpp_source.html#l00037">37</a> of file <a class="el" href="module__init_8cpp_source.html">module_init.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a92564542e0978bc542402277bd0b3a23"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="module__init_8h.html#a0622302b481431be62f9460f2cf5260e">ModuleInitState</a> UNINITIALIZED = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="module__init_8cpp_source.html#l00033">33</a> of file <a class="el" href="module__init_8cpp_source.html">module_init.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Oct 14 2013 00:58:10 for Pyrogenesis by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
